<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>filechampion4j: About FileChampion4j</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img width="200" height="150" alt="Logo" src="FileChamp_cut.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">filechampion4j<span id="projectnumber">&#160;0.9.8</span>
   </div>
   <div id="projectbrief">File validation library for Java</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">About FileChampion4j </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://codecov.io/gh/povimd9/FileChampion4j"><img src="https://codecov.io/gh/povimd9/FileChampion4j/branch/master/graph/badge.svg?token=WUCKTU7ALO" alt="codecov" style="pointer-events: none;" class="inline"/></a> <img src="https://github.com/povimd9/FileChampion4j/actions/workflows/master_build_workflow.yml/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></p>
<p>Thank you for your interest in FileChampion4j, a robust, secure, and flexible file validation library for Java. Documentation can be found via javacdoc and under the project WIKI section.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Introduction</h1>
<p>FileChampion4j is a powerful and flexible Java library for validating and processing files. The library can be used to check files for a variety of properties, including mime type, magic bytes, header signatures, footer signatures, maximum size, and more. The library can also execute extension plugins that are defined for the file type.</p>
<p><b>See <a href="https://github.com/povimd9/FileChampion4j/wiki">FileChampion4j Wiki</a> for detailed instructions on configurations and usage.</b></p>
<h2><a class="anchor" id="autotoc_md17"></a>
Features</h2>
<ul>
<li>Easy to understand and configure for developers, operations, and security engineers.</li>
<li>JSON-based configuration, supporting the ability to separate configurations from code.</li>
<li>Flexible to support various integrations, including client-defined controls.</li>
<li>Support for in-memory and on-disk validation.</li>
<li>Validate files for a variety of properties, including mime type, magic bytes, header signatures, footer signatures, maximum size, filename cleanup/encoding, and owner/permissions of file.</li>
<li>Custom plugins execution support for extended usability.</li>
<li>Comprehensive error handling and reporting.</li>
</ul>
<h2><a class="anchor" id="autotoc_md18"></a>
Benefits</h2>
<ul>
<li>Protect your system from malicious files.</li>
<li>Ensure that files are of the correct type and size.</li>
<li>Save time, effort, and risk of developing custom file validation code.</li>
<li>Allow security engineers to define required file controls without code modification.</li>
<li>Support easy auditing of controls by compliance officers and auditors.</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
Releases</h2>
<p>Working release versions, including slim/fat JARs, can be found on the <code>release-*</code> branches. A Maven Central package will be added for distribution soon.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Support</h2>
<p>FileChampion4j is intended to support Windows/Linux platforms, running any active LTS Java runtime versions. Builds are tested and packaged for supported environments. Merges and new releases must pass security, functional, and performance tests for supported environments.</p>
<p>If you have any questions about FileChampion4j, please feel free to contact the project team. The project team is available to answer questions and provide support.</p>
<p>If you found any issues or ideas, please open a relevant issue in this project.</p>
<h2><a class="anchor" id="autotoc_md21"></a>
Contributing</h2>
<p>If you would like to contribute to FileChampion4j, please feel free to fork the project on GitHub. The project team welcomes contributions of all kinds, including bug fixes, new features, and documentation improvements.</p>
<h2><a class="anchor" id="autotoc_md22"></a>
License</h2>
<p>FileChampion4j is licensed under the Apache License, Version 2.0. For more information about the license, please see the LICENSE file in the project repository.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
Basic Usage</h2>
<p>The FileValidator class is initialized with a JSON configuration object. The FileValidator.validateFile() method is the main entry point for validating files. validateFile() takes 4 arguments:</p>
<ul>
<li>Configuration category - the category defined under the "Validations" object (e.g. "Documents")</li>
<li>Target file bytes - a byte array of file content to be scanned</li>
<li>File name - the original file name associated with the target file bytes</li>
<li>Output directory - (optional) directory to which a validated file will be saved to (required for owner/permissions change)</li>
</ul>
<p>validateFile() returns a ValidationResponse object, containing:</p>
<ul>
<li>isValid - a boolean indicating whether the file is valid or not</li>
<li>resultsInfo - a string containing additional information about the validation pass/fail status</li>
<li>fileBytes - the file bytes if the file is valid (original of new file if was modified by plugins)</li>
<li>fileChecksum: the SHA-256 checksum of the file</li>
</ul>
<h2><a class="anchor" id="autotoc_md24"></a>
Configuration</h2>
<p>Example configuration of validation controls and plugins. "Validations" and at least 1 child key is required for validation to work. Plugins and steps can be defined as necessary - current implementation only supports process execution, API support will come soon.</p>
<ul>
<li>${filePath}, and ${fileChecksum} - can be used in 'endpoint' value to inject correspanding values</li>
<li>${fileContent} - can be used in 'endpoint' value to inject file content in base64 encoding</li>
<li>${STEP_NAME.filePath} - can be used to extract file path content and replace original file bytes</li>
<li>${STEP_NAME.fileContent} - can be used to extract base64 file content from base64 encoded bytes</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;Validations&quot;: {</div>
<div class="line">    &quot;Documents&quot;: {</div>
<div class="line">      &quot;pdf&quot;: {</div>
<div class="line">        &quot;mime_type&quot;: &quot;application/pdf&quot;,</div>
<div class="line">        &quot;magic_bytes&quot;: &quot;25504446&quot;,</div>
<div class="line">        &quot;header_signatures&quot;: &quot;25504446&quot;,</div>
<div class="line">        &quot;footer_signatures&quot;: &quot;2525454f46&quot;,</div>
<div class="line">        &quot;change_ownership&quot;: true,</div>
<div class="line">        &quot;change_ownership_user&quot;: &quot;User1&quot;,</div>
<div class="line">        &quot;change_ownership_mode&quot;: &quot;r&quot;,</div>
<div class="line">        &quot;name_encoding&quot;: true,</div>
<div class="line">        &quot;max_size&quot;: &quot;126000&quot;,</div>
<div class="line">        &quot;extension_plugins&quot;: [&quot;do_anti_virus_scan.step1&quot;, &quot;handle_pdf_documents.step1&quot;, &quot;handle_pdf_documents.step2&quot;]</div>
<div class="line">      },</div>
<div class="line">      &quot;doc&quot;: {</div>
<div class="line">        &quot;mime_type&quot;: &quot;application/msword&quot;,</div>
<div class="line">        &quot;magic_bytes&quot;: &quot;D0CF11E0A1B11AE1&quot;,</div>
<div class="line">        &quot;header_signatures&quot;: &quot;D0CF11E0A1B11AE1&quot;,</div>
<div class="line">        &quot;footer_signatures&quot;: &quot;0000000000000000&quot;,</div>
<div class="line">        &quot;change_ownership&quot;: true,</div>
<div class="line">        &quot;change_ownership_user&quot;: &quot;User1&quot;,</div>
<div class="line">        &quot;change_ownership_mode&quot;: &quot;r&quot;,</div>
<div class="line">        &quot;name_encoding&quot;: true,</div>
<div class="line">        &quot;max_size&quot;: &quot;4000&quot;</div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">    &quot;Images&quot;: {</div>
<div class="line">      &quot;jpg&quot;: {</div>
<div class="line">        &quot;mime_type&quot;: &quot;image/jpeg&quot;,</div>
<div class="line">        &quot;magic_bytes&quot;: &quot;FFD8&quot;,</div>
<div class="line">        &quot;header_signatures&quot;: &quot;FFD8FF&quot;,</div>
<div class="line">        &quot;footer_signatures&quot;: &quot;FFD9&quot;,</div>
<div class="line">        &quot;change_ownership&quot;: true,</div>
<div class="line">        &quot;change_ownership_user&quot;: &quot;User1&quot;,</div>
<div class="line">        &quot;change_ownership_mode&quot;: &quot;r&quot;,</div>
<div class="line">        &quot;name_encoding&quot;: true,</div>
<div class="line">        &quot;max_size&quot;: &quot;4000&quot;</div>
<div class="line">        },</div>
<div class="line">      &quot;png&quot;: {</div>
<div class="line">        &quot;mime_type&quot;: &quot;image/png&quot;,</div>
<div class="line">        &quot;magic_bytes&quot;: &quot;89504E470D0A1A0A&quot;,</div>
<div class="line">        &quot;header_signatures&quot;: &quot;89504E470D0A1A0A0000000D49484452&quot;,</div>
<div class="line">        &quot;footer_signatures&quot;: &quot;49454E44AE426082&quot;,</div>
<div class="line">        &quot;change_ownership&quot;: true,</div>
<div class="line">        &quot;change_ownership_user&quot;: &quot;User1&quot;,</div>
<div class="line">        &quot;change_ownership_mode&quot;: &quot;r&quot;,</div>
<div class="line">        &quot;name_encoding&quot;: true,</div>
<div class="line">        &quot;max_size&quot;: &quot;4000&quot;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  &quot;Plugins&quot;: {</div>
<div class="line">    &quot;do_anti_virus_scan&quot;: {</div>
<div class="line">      &quot;step1.step&quot;: {</div>
<div class="line">        &quot;type&quot;: &quot;cli&quot;,</div>
<div class="line">        &quot;run_before&quot;: true,</div>
<div class="line">        &quot;endpoint&quot;: &quot;curl -X POST -F \&quot;file=@${filePath}\&quot; https://avscanner:8080/scan&quot;,</div>
<div class="line">        &quot;timeout&quot;: 320,</div>
<div class="line">        &quot;on_timeout_or_fail&quot;: &quot;fail&quot;,</div>
<div class="line">        &quot;response&quot;: &quot;Success: ${step1.filePath}&quot;</div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">    &quot;handle_pdf_documents&quot;: {</div>
<div class="line">      &quot;step1.step&quot;: {</div>
<div class="line">        &quot;type&quot;: &quot;cli&quot;,</div>
<div class="line">        &quot;run_after&quot;: true,</div>
<div class="line">        &quot;endpoint&quot;: &quot;remove_all_active_pdf_objects.sh ${filePath}&quot;,</div>
<div class="line">        &quot;timeout&quot;: 320,</div>
<div class="line">        &quot;on_timeout_or_fail&quot;: &quot;fail&quot;,</div>
<div class="line">        &quot;response&quot;: &quot;Success: ${step1.filePath}&quot;</div>
<div class="line">      },</div>
<div class="line">      &quot;step2.step&quot;: {</div>
<div class="line">        &quot;type&quot;: &quot;cli&quot;,</div>
<div class="line">        &quot;run_after&quot;: true,</div>
<div class="line">        &quot;endpoint&quot;: &quot;save_to_db.sh ${fileContent}&quot;,</div>
<div class="line">        &quot;timeout&quot;: 320,</div>
<div class="line">        &quot;on_timeout_or_fail&quot;: &quot;fail&quot;,</div>
<div class="line">        &quot;response&quot;: &quot;Success: ${step1.fileContent}&quot;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md25"></a>
Example</h2>
<p>The following code shows a simple implementation example:</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> java.io.File;</div>
<div class="line"><span class="keyword">import</span> java.io.IOException;</div>
<div class="line"><span class="keyword">import</span> java.nio.file.Files;</div>
<div class="line"><span class="keyword">import</span> java.nio.file.Paths;</div>
<div class="line"><span class="keyword">import</span> org.json.JSONObject;</div>
<div class="line"><span class="keyword">import</span> dev.filechampion.filechampion4j.FileValidator;</div>
<div class="line"><span class="keyword">import</span> dev.filechampion.filechampion4j.ValidationResponse;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>Main {</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> main(String[] args) {</div>
<div class="line">        <span class="comment">// Path to the file to be validated in this simple example</span></div>
<div class="line">        File pdfFile = <span class="keyword">new</span> File(<span class="stringliteral">&quot;samples/In/test.pdf&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Path to the config.json file</span></div>
<div class="line">        String configPath = <span class="stringliteral">&quot;config/config.json&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Placeholders for the JSON object and the file in bytes</span></div>
<div class="line">        JSONObject jsonObject = <span class="keyword">null</span>;</div>
<div class="line">        <span class="keywordtype">byte</span>[] fileInBytes = <span class="keyword">null</span>;</div>
<div class="line">        FileValidator validator = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Path to the output directory</span></div>
<div class="line">        String outDir = <span class="stringliteral">&quot;samples/Out/&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Create a new FileValidator object with json config file</span></div>
<div class="line">        <span class="keywordflow">try</span> {</div>
<div class="line">            <span class="comment">// Read the JSON object from the config.json file</span></div>
<div class="line">            String jsonConfigContent = <span class="keyword">new</span> String(Files.readAllBytes(Paths.get(configPath)));</div>
<div class="line">            jsonObject = <span class="keyword">new</span> JSONObject(jsonConfigContent);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Create a new FileValidator object</span></div>
<div class="line">            validator = <span class="keyword">new</span> FileValidator(jsonObject);</div>
<div class="line">        } <span class="keywordflow">catch</span> (IOException e) {</div>
<div class="line">            e.printStackTrace();</div>
<div class="line">            System.exit(1);</div>
<div class="line">        } <span class="keywordflow">catch</span> (IllegalArgumentException e) {</div>
<div class="line">            System.out.println(<span class="stringliteral">&quot;Error creating FileValidator object&quot;</span>);</div>
<div class="line">            System.exit(1);</div>
<div class="line">        } <span class="keywordflow">catch</span> (Exception e) {</div>
<div class="line">            System.out.println(<span class="stringliteral">&quot;Error reading config file&quot;</span>);</div>
<div class="line">            System.exit(1);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">try</span> {</div>
<div class="line">            <span class="comment">// Read the file to be validated into a byte array</span></div>
<div class="line">            fileInBytes = Files.readAllBytes(pdfFile.toPath());</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Validate the file</span></div>
<div class="line">            ValidationResponse fileValidationResults = validator.validateFile(<span class="stringliteral">&quot;Documents&quot;</span>, fileInBytes, pdfFile.getName(),outDir);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Check if the file is valid</span></div>
<div class="line">            <span class="keywordflow">if</span> (fileValidationResults.isValid()) {</div>
<div class="line">                <span class="comment">// Print the results if the file is valid</span></div>
<div class="line">                String validMessage = String.format(<span class="stringliteral">&quot;%s is a valid document file.%n New file: %s, Checksum: %s&quot;</span>,</div>
<div class="line">                        fileValidationResults.resultsInfo(),</div>
<div class="line">                        fileValidationResults.getValidFilePath().length == 0 ? <span class="stringliteral">&quot;&quot;</span> : fileValidationResults.getValidFilePath()[0],</div>
<div class="line">                        fileValidationResults.getFileChecksum());</div>
<div class="line">                System.out.println(validMessage);</div>
<div class="line">                System.exit(0);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="comment">// Print the results if the file is invalid</span></div>
<div class="line">                System.out.println(pdfFile.getName() + <span class="stringliteral">&quot; is not a valid document file  because &quot;</span> + fileValidationResults.resultsInfo());</div>
<div class="line">                System.exit(0);</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">catch</span> (IOException e) {</div>
<div class="line">            e.printStackTrace();</div>
<div class="line">            System.exit(1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Apr 21 2023 23:23:14 for filechampion4j by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
