<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PluginsHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">filechampion4j</a> &gt; <a href="index.source.html" class="el_package">dev.filechampion.filechampion4j</a> &gt; <span class="el_source">PluginsHelper.java</span></div><h1>PluginsHelper.java</h1><pre class="source lang-java linenums">package dev.filechampion.filechampion4j;

import org.json.*;
import java.util.HashMap;
import java.util.Map;

/**
 * This class is used to fetch and load the Json configuration data for all plugins.
 * Allowing the Json configuration data to be loaded once and then used by all plugins.
 * Returns a list of PluginConfig objects.
 */
public class PluginsHelper {
    private JSONObject plugins;

    /**
     * Constructor
     * @param plugins (JSONObject) a JSONObject containing plugin configuration data
     */
<span class="fc" id="L19">    public PluginsHelper(JSONObject plugins) {</span>
<span class="fc" id="L20">        this.plugins = plugins;</span>
<span class="fc" id="L21">    }</span>

    /**
     * Returns a list of PluginConfig objects.
     * @return (HashMap&amp;lt;String, PluginConfig&amp;gt;) a map of PluginConfig objects
     */
    public Map&lt;String, PluginConfig&gt; getPluginConfigs() {
<span class="fc" id="L28">        HashMap&lt;String, PluginConfig&gt; pluginConfigs = new HashMap&lt;&gt;();</span>
<span class="fc" id="L29">        Map&lt;String, StepConfig&gt; stepConfigs = new HashMap&lt;&gt;();</span>


<span class="fc bfc" id="L32" title="All 2 branches covered.">        for (String pluginName : plugins.keySet()) {</span>
<span class="fc" id="L33">            JSONObject plugin = plugins.getJSONObject(pluginName);</span>
<span class="fc" id="L34">            PluginConfig pluginConfig = new PluginConfig();</span>
<span class="fc" id="L35">            pluginConfig.setName(pluginName);</span>

<span class="fc bfc" id="L37" title="All 2 branches covered.">            for (String stepName : plugin.keySet()) {</span>
<span class="fc" id="L38">                JSONObject step = plugin.getJSONObject(stepName);</span>
<span class="fc" id="L39">                StepConfig stepConfig = new StepConfig();</span>
<span class="fc" id="L40">                String pluginStepName = pluginName + &quot;.&quot; + stepName.substring(0, stepName.lastIndexOf('.'));</span>
<span class="fc" id="L41">                stepConfig.setName(pluginStepName);</span>

<span class="fc" id="L43">                stepConfig.setType(step.getString(&quot;type&quot;));</span>
<span class="fc" id="L44">                stepConfig.setRunBefore(step.optBoolean(&quot;run_before&quot;));</span>
<span class="fc" id="L45">                stepConfig.setRunAfter(step.optBoolean(&quot;run_after&quot;));</span>
<span class="fc" id="L46">                stepConfig.setCredsPath(step.optString(&quot;creds_path&quot;));</span>
<span class="fc" id="L47">                stepConfig.setTimeout(step.getInt(&quot;timeout&quot;));</span>
<span class="fc" id="L48">                stepConfig.setOnFail(step.getString(&quot;on_timeout_or_fail&quot;));</span>
<span class="fc" id="L49">                stepConfig.setEndpoint(step.getString(&quot;endpoint&quot;));</span>
<span class="fc" id="L50">                stepConfig.setResponse(step.getString(&quot;response&quot;));</span>

<span class="pc bpc" id="L52" title="1 of 3 branches missed.">                switch (stepConfig.getType()) {</span>
                    case &quot;cli&quot;:
<span class="fc" id="L54">                        CliPluginHelper cliPluginStep = new CliPluginHelper(stepConfig);</span>
<span class="fc" id="L55">                        stepConfig.setCliPluginHelper(cliPluginStep);</span>
<span class="fc" id="L56">                        stepConfigs.put(pluginStepName, stepConfig);</span>

<span class="fc" id="L58">                        continue;</span>
                    case &quot;http&quot;:
<span class="fc" id="L60">                        stepConfig.setMethod(step.optString(&quot;method&quot;));</span>
<span class="fc" id="L61">                        stepConfig.setHeaders(step.optJSONObject(&quot;headers&quot;));</span>
<span class="fc" id="L62">                        stepConfig.setBody(step.optJSONObject(&quot;body&quot;));</span>
<span class="fc" id="L63">                        stepConfig.setHttpPassCode(step.optInt(&quot;http_pass_code&quot;));</span>
<span class="fc" id="L64">                        stepConfig.setHttpFailCode(step.optInt(&quot;http_fail_code&quot;));</span>
<span class="fc" id="L65">                        stepConfigs.put(pluginStepName, stepConfig);</span>
<span class="fc" id="L66">                        continue;</span>
                    default:
<span class="nc" id="L68">                        continue;</span>
                }
            }
<span class="fc" id="L71">            pluginConfig.setStepConfigs(stepConfigs);</span>
<span class="fc" id="L72">            pluginConfigs.put(pluginName, pluginConfig);</span>
<span class="fc" id="L73">        }</span>
<span class="fc" id="L74">        return pluginConfigs;</span>
    }

    /**
     * Class to set and return a single plugin configuration.
     */
<span class="fc" id="L80">    public static class PluginConfig {</span>
        private String name;
        private Map&lt;String, StepConfig&gt; stepConfigs;

        /**
         * Constructor
         * @return (String) the name of the plugin (e.g. &quot;av_scan&quot;
         */
        public String getName() {
<span class="nc" id="L89">            return name;</span>
        }

        /**
         * Set the name of the plugin.
         * @param name (String) the name of the plugin (e.g. &quot;av_scan&quot;)
         */
        public void setName(String name) {
<span class="fc" id="L97">            this.name = name;</span>
<span class="fc" id="L98">        }</span>

        /**
         * Return a map of StepConfig objects.
         * @return (Map&amp;lt;String, StepConfig&amp;gt;) a map of StepConfig objects
         */
        public Map&lt;String, StepConfig&gt; getStepConfigs() {
<span class="fc" id="L105">            return stepConfigs;</span>
        }

        /**
         * Set a map of StepConfig objects.
         * @param stepConfigs (Map&amp;lt;String, StepConfig&amp;gt;) a map of StepConfig objects
         */
        public void setStepConfigs(Map&lt;String, StepConfig&gt; stepConfigs) {
<span class="fc" id="L113">            this.stepConfigs = stepConfigs;</span>
<span class="fc" id="L114">        }</span>
    }

    /**
     * Class to set and return a single step configuration.
     */
<span class="fc" id="L120">    public static class StepConfig {</span>
        private String name;
        private String type;
        private String endpoint;
        private int timeout;
        private String onFail;
        private String response;
        private String method;
        private JSONObject headers;
        private JSONObject body;    
        private int httpPassCode;
        private int httpFailCode;
        private String credsPath;
        private CliPluginHelper cliPluginHelper;
        private boolean runBefore;
        private boolean runAfter;

        /**
         * Check if run_before is set to true.
         * @return (boolean) true if run_before is set to true, false otherwise
         */
        public boolean isRunBefore() {
<span class="fc" id="L142">            return runBefore;</span>
        }

        /**
         * Set run_before to true or false.
         * @param runBefore (boolean) true if run_before is set to true, false otherwise
         */
        public void setRunBefore(boolean runBefore) {
<span class="fc" id="L150">            this.runBefore = runBefore;</span>
<span class="fc" id="L151">        }</span>

        /**
         * Check if run_after is set to true.
         * @return (boolean) true if run_after is set to true, false otherwise
         */
        public boolean isRunAfter() {
<span class="fc" id="L158">            return runAfter;</span>
        }

        /**
         * Set run_after to true or false.
         * @param runAfter (boolean) true if run_after is set to true, false otherwise
         */
        public void setRunAfter(boolean runAfter) {
<span class="fc" id="L166">            this.runAfter = runAfter;</span>
<span class="fc" id="L167">        }</span>

        /**
         * Return a CliPluginHelper object.
         * @return (CliPluginHelper) a CliPluginHelper object
         */
        public CliPluginHelper getCliPluginHelper() {
<span class="fc" id="L174">            return cliPluginHelper;</span>
        }

        /**
         * Set a CliPluginHelper object.
         * @param cliPluginHelper (CliPluginHelper) a CliPluginHelper object
         */
        public void setCliPluginHelper(CliPluginHelper cliPluginHelper) {
<span class="fc" id="L182">            this.cliPluginHelper = cliPluginHelper;</span>
<span class="fc" id="L183">        }</span>

        /**
         * Return the name of the step.
         * @return (String) the name of the step
         */
        public String getName() {
<span class="fc" id="L190">            return name;</span>
        }

        /**
         * Set the name of the step.
         * @param name (String) the name of the step
         */
        public void setName(String name) {
<span class="fc" id="L198">            this.name = name;</span>
<span class="fc" id="L199">        }</span>

        /**
         * Return the type of the step.
         * @return (String) the type of the step
         */
        public String getType() {
<span class="fc" id="L206">            return type;</span>
        }

        /**
         * Set the type of the step.
         * @param type (String) the type of the step
         */
        public void setType(String type) {
<span class="fc" id="L214">            this.type = type;</span>
<span class="fc" id="L215">        }</span>

        /**
         * Return the endpoint of the step.
         * @return (String) the endpoint of the step
         */
        public String getEndpoint() {
<span class="fc" id="L222">            return endpoint;</span>
        }

        /**
         * Set the endpoint of the step.
         * @param endpoint (String) the endpoint of the step
         */
        public void setEndpoint(String endpoint) {
<span class="fc" id="L230">            this.endpoint = endpoint;</span>
<span class="fc" id="L231">        }</span>

        /**
         * Return the timeout of the step.
         * @return (int) the timeout of the step
         */
        public int getTimeout() {
<span class="fc" id="L238">            return timeout;</span>
        }

        /**
         * Set the timeout of the step.
         * @param timeout (int) the timeout of the step
         */
        public void setTimeout(int timeout) {
<span class="fc" id="L246">            this.timeout = timeout;</span>
<span class="fc" id="L247">        }</span>

        /**
         * Return the onFail of the step.
         * @return (String) the onFail of the step
         */
        public String getOnFail() {
<span class="fc" id="L254">            return onFail;</span>
        }

        /**
         * Set the onFail of the step.
         * @param onFail (String) the onFail of the step
         */
        public void setOnFail(String onFail) {
<span class="fc" id="L262">            this.onFail = onFail;</span>
<span class="fc" id="L263">        }</span>

        /**
         * Return the response of the step.
         * @return (String) the response of the step
         */
        public String getResponse() {
<span class="fc" id="L270">            return response;</span>
        }

        /**
         * Set the response of the step.
         * @param response (String) the response of the step
         */
        public void setResponse(String response) {
<span class="fc" id="L278">            this.response = response;</span>
<span class="fc" id="L279">        }</span>

        /**
         * Return the method of the step.
         * @return (String) the method of the step
         */
        public String getMethod() {
<span class="nc" id="L286">            return method;</span>
        }

        /**
         * Set the method of the step.
         * @param method (String) the method of the step
         */
        public void setMethod(String method) {
<span class="fc" id="L294">            this.method = method;</span>
<span class="fc" id="L295">        }</span>

        /**
         * Return the headers of the step.
         * @return (JSONObject) the headers of the step
         */
        public JSONObject getHeaders() {
<span class="nc" id="L302">            return headers;</span>
        }

        /**
         * Set the headers of the step.
         * @param headers (JSONObject) the headers of the step
         */
        public void setHeaders(JSONObject headers) {
<span class="fc" id="L310">            this.headers = headers;</span>
<span class="fc" id="L311">        }</span>

        /**
         * Return the body of the step.
         * @return (JSONObject) the body of the step
         */
        public JSONObject getBody() {
<span class="nc" id="L318">            return body;</span>
        }

        /**
         * Set the body of the step.
         * @param body (JSONObject) the body of the step
         */
        public void setBody(JSONObject body) {
<span class="fc" id="L326">            this.body = body;</span>
<span class="fc" id="L327">        }</span>

        /**
         * Return the httpPassCode of the step.
         * @return (int) the httpPassCode of the step
         */
        public int getHttpPassCode() {
<span class="nc" id="L334">            return httpPassCode;</span>
        }

        /**
         * Set the httpPassCode of the step.
         * @param httpPassCode (int) the httpPassCode of the step
         */
        public void setHttpPassCode(int httpPassCode) {
<span class="fc" id="L342">            this.httpPassCode = httpPassCode;</span>
<span class="fc" id="L343">        }</span>

        /**
         * Return the httpFailCode of the step.
         * @return (int) the httpFailCode of the step
         */
        public int getHttpFailCode() {
<span class="nc" id="L350">            return httpFailCode;</span>
        }

        /**
         * Set the httpFailCode of the step.
         * @param httpFailCode (int) the httpFailCode of the step
         */
        public void setHttpFailCode(int httpFailCode) {
<span class="fc" id="L358">            this.httpFailCode = httpFailCode;</span>
<span class="fc" id="L359">        }</span>

        /**
         * Return the credsPath of the step.
         * @return (String) the credsPath of the step
         */
        public String getCredsPath() {
<span class="nc" id="L366">            return credsPath;</span>
        }

        /**
         * Set the credsPath of the step.
         * @param credsPath (String) the credsPath of the step
         */
        public void setCredsPath(String credsPath) {
<span class="fc" id="L374">            this.credsPath = credsPath;</span>
<span class="fc" id="L375">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>